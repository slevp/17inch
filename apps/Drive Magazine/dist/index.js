define("ekai/drive-magazine/1.0.0/main",["backbone","ekai/drive-magazine/1.0.0/routers/index","ekai/drive-magazine/1.0.0/views/home","underscore","store","ekai/drive-magazine/1.0.0/data/data.json","ekai/drive-magazine/1.0.0/collections/books","ekai/drive-magazine/1.0.0/models/book","topivi","ekai/drive-magazine/1.0.0/views/details","iscroll","ekai/drive-magazine/1.0.0/collections/images","ekai/drive-magazine/1.0.0/models/image","iscroll/5.1.2/iscroll-probe"],function(a){var b=a("backbone"),c=a("ekai/drive-magazine/1.0.0/routers/index");new c,b.history.start()}),define("ekai/drive-magazine/1.0.0/routers/index",["backbone","ekai/drive-magazine/1.0.0/views/home","underscore","store","ekai/drive-magazine/1.0.0/data/data.json","ekai/drive-magazine/1.0.0/collections/books","ekai/drive-magazine/1.0.0/models/book","topivi","ekai/drive-magazine/1.0.0/views/details","iscroll","ekai/drive-magazine/1.0.0/collections/images","ekai/drive-magazine/1.0.0/models/image","iscroll/5.1.2/iscroll-probe"],function(a,b,c){var d=a("backbone");d.$;var e=a("ekai/drive-magazine/1.0.0/views/home"),f=a("ekai/drive-magazine/1.0.0/views/details"),g=null,h=null;c.exports=d.Router.extend({routes:{"":"homePage","book/:bookId":"details"},homePage:function(){var a=this;g?(d.$("body").find(".active").removeClass("active"),g.$el.addClass("active")):(g=new e,d.$("body").append(g.render().el),d.$(".page.active").removeClass("active"),g.$el.addClass("active")),this.listenTo(g,"clickBook",function(b){a.navigate(b,{trigger:!0})})},details:function(a){h&&h.remove(),h=new f({bookId:a}),d.$(".page.active").removeClass("active"),d.$("body").append(h.render().el),h.$el.addClass("active")}})}),define("ekai/drive-magazine/1.0.0/views/home",["backbone","underscore","store","ekai/drive-magazine/1.0.0/data/data.json","ekai/drive-magazine/1.0.0/collections/books","ekai/drive-magazine/1.0.0/models/book","topivi"],function(a,b,c){var d=a("backbone"),e=a("underscore"),f=d.$,g=a("store"),h=a("ekai/drive-magazine/1.0.0/data/data.json"),i=a("ekai/drive-magazine/1.0.0/templates/home.tpl"),j=a("ekai/drive-magazine/1.0.0/collections/books");g.set("books",h.Data);var k=g.get("books");c.exports=d.View.extend({className:"page home",template:e.template(i),constructor:function(){d.View.apply(this,arguments)},events:{"click .item":"clickBook"},initialize:function(){this.collection=new j(k)},render:function(){return this.delegateEvents(),this.collection.length>0&&console.log(this.collection.length),this.$el.empty(),this.$el.append(this.template({books:k,length:this.collection.length})),this},clickBook:function(a){a.stopImmediatePropagation();var b=f(a.currentTarget),c=b.attr("data-key");parseInt(c)>1||this.trigger("clickBook","#/book/"+c)}})}),define("ekai/drive-magazine/1.0.0/data/data.json",[],{Data:[{id:"1",name:"智驾杂志",type:"",cover:"magazine/autor/1111.jpg",img:[{src:"magazine/autor/AutoR4.jpg"},{src:"magazine/autor/AutoR6.jpg"},{src:"magazine/autor/AutoR8.jpg"},{src:"magazine/autor/AutoR10.jpg"},{src:"magazine/autor/AutoR22.jpg"},{src:"magazine/autor/AutoR23.jpg"},{src:"magazine/autor/AutoR24.jpg"},{src:"magazine/autor/AutoR25.jpg"},{src:"magazine/autor/AutoR27.jpg"},{src:"magazine/autor/AutoR28.jpg"},{src:"magazine/autor/AutoR34.jpg"},{src:"magazine/autor/AutoR36.jpg"},{src:"magazine/autor/AutoR37.jpg"}],time:"1413363707"},{id:"2",name:"汽车杂志",type:"",cover:"magazine/qichezazhi/qichezazhi_01.png",img:[{src:"magazine/qichezazhi/qichezazhi_06.png"},{src:"magazine/qichezazhi/qichezazhi_07.png"},{src:"magazine/qichezazhi/qichezazhi_08.png"},{src:"magazine/qichezazhi/qichezazhi_09.png"},{src:"magazine/qichezazhi/qichezazhi_10.png"},{src:"magazine/qichezazhi/qichezazhi_11.png"},{src:"magazine/qichezazhi/qichezazhi_12.png"},{src:"magazine/qichezazhi/qichezazhi_13.png"}],time:"1413363707"},{id:"3",name:"智驾杂志",type:"",cover:"magazine/autor/3333.jpg",img:[],time:"1413363707"},{id:"4",name:"智驾杂志",type:"",cover:"magazine/autor/4444.jpg",img:[],time:"1413363707"},{id:"5",name:"智驾杂志",type:"",cover:"magazine/autor/5555.jpg",img:[],time:"1413363707"},{id:"6",name:"智驾杂志",type:"",cover:"magazine/autor/6666.jpg",img:[],time:"1413363707"}]}),define("ekai/drive-magazine/1.0.0/templates/home.tpl",[],'<div class="main">\n    <ul>\n    {{\n        var height = Math.floor(length/4) + 1;\n        for( var i = 0; i < 3 ; i ++) {\n        var m = 4 *(i+1);\n    }}\n        <li class="column">\n            <div class="books">\n                {{\n                    for(var n = 4 * i; n < m; n ++) {\n                        if (n > length - 1) {\n                            break;\n                        }\n                }}\n                        <div class="item {{=books[n].img.length <= 0 ? \'no-data\' : \'\'}}" data-key="{{=n}}">\n                            <img alt="" src="{{=books[n].cover}}"/>\n                            <p class="label">未下载</p>\n                        </div>\n\n                {{\n                    }\n                }}\n            </div>\n         </li>\n{{\n    }\n}}\n            </ul>\n    <div class="shop-btn">\n        <a href="#/shop">商店</a>\n    </div>\n</div>\n'),define("ekai/drive-magazine/1.0.0/collections/books",["backbone","ekai/drive-magazine/1.0.0/models/book","underscore","topivi"],function(a,b,c){var d=a("backbone"),e=a("ekai/drive-magazine/1.0.0/models/book");c.exports=d.Collection.extend({model:e,url:function(){},parse:function(a){return a.apps}})}),define("ekai/drive-magazine/1.0.0/models/book",["backbone","underscore","topivi"],function(a,b,c){var d=a("backbone");a("underscore"),a("topivi"),c.exports=d.Model.extend({initialize:function(){}})}),define("ekai/drive-magazine/1.0.0/views/details",["backbone","underscore","iscroll","store","ekai/drive-magazine/1.0.0/collections/images","ekai/drive-magazine/1.0.0/models/image","iscroll/5.1.2/iscroll-probe"],function(a,b,c){var d=a("backbone"),e=a("underscore");d.$,a("iscroll");var f=a("store"),g=a("ekai/drive-magazine/1.0.0/templates/details.tpl"),h=a("ekai/drive-magazine/1.0.0/collections/images"),i=f.get("books"),j=a("iscroll/5.1.2/iscroll-probe"),k=!1,l=!1;c.exports=d.View.extend({className:"page read ",template:e.template(g),constructor:function(){d.View.apply(this,arguments)},initialize:function(a){var b=a.bookId;this.bookId=b,this.collection=new h(i[this.bookId].img)},events:{"click .content .imgs":"showHead"},render:function(){var a=this;this.$el.empty(),this.$el.append(this.template({title:i[this.bookId].name,imageData:this.collection.models}));var b=this.$el.find(".content .progress-line"),c=b.offset().top,d=this.$el.find(".content .circle");return setTimeout(function(){a.resetScrollWidth(),a.scroll=new j(".content",{scrollX:!0,scrollY:!1,probeType:1,zoom:!0,wheelAction:"zoom"});var e=b.height();a.$el.find(".circle").drag("options",{axis:"y",min:{top:0},max:{top:e},ondrag:function(){k=!0;var b=d.offset().top,f=b-c,g=f/e,h=Math.floor(g*a.collection.length);h>a.collection.length&&(h=a.collection.length);var i=a.$el.find(".content ul li:eq("+(h-1)+")");a.scroll.scrollToElement(i[0],500),a.$el.find(".head").hide()},ondragend:function(){k=!1,a.$el.find(".head").hide()}}),a.scroll.on("scroll",function(){if(l=!0,!k){var b=Math.abs(this.x),d=b/Math.abs(this.maxScrollX),f=e*d,g=c+f;a.$el.find(".content .progress .circle").css("top",g),a.$el.find(".head").hide()}}),a.scroll.on("scrollEnd",function(){l=!1})},200),this.setHideHeaderTimeout(),this},setHideHeaderTimeout:function(){var a=this;this.headerTimeout=setTimeout(function(){a.$el.find(".head").fadeOut(1e3)},5e3)},resetScrollWidth:function(){var a=this.$el.find(".content"),b=a.width(),c=this.collection.length*b;a.find("ul.imgs").css("width",c),a.find("ul.imgs>li").css("width",b)},showHead:function(){l||(this.headerTimeout&&clearTimeout(this.headerTimeout),this.$el.find(".head").fadeIn(600),this.setHideHeaderTimeout())}})}),define("ekai/drive-magazine/1.0.0/templates/details.tpl",[],'\n<div class="content">\n    <ul class="imgs">\n        {{\n            for(var i = 0; i< imageData.length; i++ ){\n        }}\n            <li>\n                <img alt="" class="" src="{{=imageData[i].get(\'src\')}}"></img>\n            </li>\n        {{\n            }\n        }}\n    </ul>\n    <div class="progress">\n        <div class="progress-line">\n            <div class="browsed"></div>\n            <div class="browing"></div>\n        </div>\n        <div class="circle"></div>\n    </div>\n</div>\n<div class="head">\n    <p class="title">{{=title}}</p>\n    <div class="back-btn active">\n        <a href="#"></a>\n    </div>\n    <div class="bookrack">\n        <a href="#">我的书架</a>\n    </div>\n</div>'),define("ekai/drive-magazine/1.0.0/collections/images",["backbone","ekai/drive-magazine/1.0.0/models/image","underscore"],function(a,b,c){var d=a("backbone"),e=a("ekai/drive-magazine/1.0.0/models/image");c.exports=d.Collection.extend({model:e,url:function(){},parse:function(a){return a.apps}})}),define("ekai/drive-magazine/1.0.0/models/image",["backbone","underscore"],function(a,b,c){var d=a("backbone");a("underscore"),c.exports=d.Model.extend({initialize:function(){}})});
