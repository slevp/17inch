define("ekai/seventeen-inch/1.0.0/main",["backbone","ekai/seventeen-inch/1.0.0/routers/index","underscore","store","ekai/seventeen-inch/1.0.0/views/home","ekai/seventeen-inch/1.0.0/settings.json","ekai/seventeen-inch/1.0.0/data/home-info.json","ekai/seventeen-inch/1.0.0/data/apps.json","ekai/seventeen-inch/1.0.0/collections/app","ekai/seventeen-inch/1.0.0/models/app","ekai/seventeen-inch/1.0.0/views/header","jquery","topivi","ekai/seventeen-inch/1.0.0/views/apps/wheel-press/index","ekai/seventeen-inch/1.0.0/views/apps/weather/index","ekai/seventeen-inch/1.0.0/views/apps/weather/collections/weather","ekai/seventeen-inch/1.0.0/views/apps/weather/models/weather","ekai/seventeen-inch/1.0.0/views/apps/weather/settings.json","ekai/seventeen-inch/1.0.0/views/apps/weather/weather-item","ekai/seventeen-inch/1.0.0/views/apps/oil/index","ekai/seventeen-inch/1.0.0/views/apps/oil/collections/city-oil","ekai/seventeen-inch/1.0.0/views/apps/oil/models/city-oil","ekai/seventeen-inch/1.0.0/views/apps/oil/models/today-oil","ekai/seventeen-inch/1.0.0/views/apps/VR/callback","iscroll","ekai/seventeen-inch/1.0.0/views/app","ekai/seventeen-inch/1.0.0/views/footer","ekai/seventeen-inch/1.0.0/views/nav","ekai/seventeen-inch/1.0.0/views/nav-item","ekai/seventeen-inch/1.0.0/views/footer-apps"],function(a){var b=a("backbone"),c=b.$,d=a("ekai/seventeen-inch/1.0.0/routers/index");new d,b.history.start(),c(document).ready(function(){c("#exit-btn").click(function(){var a=tizen.application.getCurrentApplication();a.exit()})})}),define("ekai/seventeen-inch/1.0.0/routers/index",["backbone","underscore","store","ekai/seventeen-inch/1.0.0/views/home","ekai/seventeen-inch/1.0.0/settings.json","ekai/seventeen-inch/1.0.0/data/home-info.json","ekai/seventeen-inch/1.0.0/data/apps.json","ekai/seventeen-inch/1.0.0/collections/app","ekai/seventeen-inch/1.0.0/models/app","ekai/seventeen-inch/1.0.0/views/header","jquery","topivi","ekai/seventeen-inch/1.0.0/views/apps/wheel-press/index","ekai/seventeen-inch/1.0.0/views/apps/weather/index","ekai/seventeen-inch/1.0.0/views/apps/weather/collections/weather","ekai/seventeen-inch/1.0.0/views/apps/weather/models/weather","ekai/seventeen-inch/1.0.0/views/apps/weather/settings.json","ekai/seventeen-inch/1.0.0/views/apps/weather/weather-item","ekai/seventeen-inch/1.0.0/views/apps/oil/index","ekai/seventeen-inch/1.0.0/views/apps/oil/collections/city-oil","ekai/seventeen-inch/1.0.0/views/apps/oil/models/city-oil","ekai/seventeen-inch/1.0.0/views/apps/oil/models/today-oil","ekai/seventeen-inch/1.0.0/views/apps/VR/callback","iscroll","ekai/seventeen-inch/1.0.0/views/app","ekai/seventeen-inch/1.0.0/views/footer","ekai/seventeen-inch/1.0.0/views/nav","ekai/seventeen-inch/1.0.0/views/nav-item","ekai/seventeen-inch/1.0.0/views/footer-apps"],function(a,b,c){var d=a("backbone"),e=d.$;a("underscore"),a("store");var f=a("ekai/seventeen-inch/1.0.0/views/home"),g=null;c.exports=d.Router.extend({routes:{"":"main",":page":"main"},main:function(a){a=a||"home",g||this.initPage(),"home"===a?g.trigger("backToHome"):g.trigger("displayApp",{app:a})},initPage:function(){g=new f,e("body").prepend(g.render().el),this.listenTo(g,"backToHome",this.changeHash),this.listenTo(g,"displayApp",this.changeHash)},changeHash:function(a){a&&a.navigate&&(a.hash=a.hash||"home",this.navigate(a.hash,{trigger:!1}))}})}),define("ekai/seventeen-inch/1.0.0/views/home",["backbone","underscore","store","ekai/seventeen-inch/1.0.0/settings.json","ekai/seventeen-inch/1.0.0/data/home-info.json","ekai/seventeen-inch/1.0.0/data/apps.json","ekai/seventeen-inch/1.0.0/collections/app","ekai/seventeen-inch/1.0.0/models/app","ekai/seventeen-inch/1.0.0/views/header","jquery","topivi","ekai/seventeen-inch/1.0.0/views/apps/wheel-press/index","ekai/seventeen-inch/1.0.0/views/apps/weather/index","ekai/seventeen-inch/1.0.0/views/apps/weather/collections/weather","ekai/seventeen-inch/1.0.0/views/apps/weather/models/weather","ekai/seventeen-inch/1.0.0/views/apps/weather/settings.json","ekai/seventeen-inch/1.0.0/views/apps/weather/weather-item","ekai/seventeen-inch/1.0.0/views/apps/oil/index","ekai/seventeen-inch/1.0.0/views/apps/oil/collections/city-oil","ekai/seventeen-inch/1.0.0/views/apps/oil/models/city-oil","ekai/seventeen-inch/1.0.0/views/apps/oil/models/today-oil","ekai/seventeen-inch/1.0.0/views/apps/VR/callback","iscroll","ekai/seventeen-inch/1.0.0/views/app","ekai/seventeen-inch/1.0.0/views/footer","ekai/seventeen-inch/1.0.0/views/nav","ekai/seventeen-inch/1.0.0/views/nav-item","ekai/seventeen-inch/1.0.0/views/footer-apps"],function(a,b,c){var d=a("backbone"),e=a("underscore"),f=a("store"),g=a("ekai/seventeen-inch/1.0.0/settings.json").STORAGE_KEYS,h=f.get(g.home_info);h||(h=a("ekai/seventeen-inch/1.0.0/data/home-info.json"),f.set(g.home_info,h));var i=f.get(g.apps);i||(i=a("ekai/seventeen-inch/1.0.0/data/apps.json"));var j=a("ekai/seventeen-inch/1.0.0/collections/app"),k=new j(i);f.set(g.apps,k.toJSON());var l=a("ekai/seventeen-inch/1.0.0/templates/home.tpl"),m=a("ekai/seventeen-inch/1.0.0/views/header"),n=a("ekai/seventeen-inch/1.0.0/views/app"),o=a("ekai/seventeen-inch/1.0.0/views/footer");c.exports=d.View.extend({id:"home-container",className:"no-app",template:e.template(l),events:{"swipeup #header-container":"swipeUpEvent","swipedown #header-container":"swipeDownEvent"},constructor:function(){d.View.apply(this,arguments)},initialize:function(){var a=this;this.atHomePage=!0,this.headerView=new m,this.appView=new n({appCollection:k}),this.footerView=new o({appManager:this.appView.appManager,appCollection:k}),this.on("backToHome",this.backToHome),this.on("displayApp",this.displayApp),this.listenTo(k,"updateHomeApps",this.updateStoreApps),d.$(document).on("openApp",function(b,c){return k.findWhere({name:c})?(a.trigger("displayApp",{app:c,navigate:!0,hash:c}),void 0):console.error("App: "+c+" has not been installed.")})},render:function(){return this.$el.empty(),this.$el.html(this.template({})),this.$el.append(this.headerView.render().el),this.$el.append(this.appView.render().el),this.$el.append(this.footerView.render().el),this.footerView.navView.activeItem("home"),this},backToHome:function(a){var b=this;if(!this.atHomePage){var c,d=this.appView.currentApp,e=this.footerView.appsView.leftAppName,f=this.footerView.appsView.rightAppName,g=function(){b.headerView.trigger("changeMode",{mode:"big"}),b.footerView.navView.activeItem("home"),b.$el.addClass("no-app"),b.atHomePage=!0,(d===f||d===e)&&(c=d===e?"left":"right",b.footerView.appsView.trigger("resetApp",c))};a&&a.from&&"swipe-down"==a.from?this.showHomeAnimation(g,{ease:"easeInQuint"}):this.showHomeAnimation(g,{ease:"easeInBack"})}},displayApp:function(a){var b,c=this,d=a.app,e=this.footerView.appsView.leftAppName,f=this.footerView.appsView.rightAppName,g=this.appView.currentApp,h=function(a){a=a||{};var b=a.resetHeader;b&&(c.headerView.trigger("changeMode",{mode:"small"}),c.headerView.$el.hide().fadeIn(200)),c.footerView.navView.activeItem(d),c.appView.trigger("switchApp",d),c.$el.removeClass("no-app"),c.atHomePage=!1},i=function(a){a=a||h,c.atHomePage?c.showAppAnimation(a):c.switchAppAnimation(a,d)};d===e||d===f?(b=d===e?"left":"right",this.footerView.appsView.trigger("switchApp",b,i)):(b=g===e?"left":"right",g===f||g===e?i(function(){h.apply(this,arguments),c.footerView.appsView.trigger("resetApp",b)}):i())},swipeDownEvent:function(){this.atHomePage||this.trigger("backToHome",{navigate:!0,hash:"home",from:"swipe-down"})},swipeUpEvent:function(){if(this.atHomePage&&!this.swippingUp){var a=this.appView.currentApp;if(a)this.trigger("displayApp",{app:a,navigate:!0,hash:a});else{var b=this,c=this.headerView.$el;this.swippingUp=!0,c.animate({top:"-20%"},"normal","easeOutCirc",function(){c.animate({top:"0"},"normal","easeOutBounce",function(){b.swippingUp=!1})})}}},showAppAnimation:function(a){var b=this.headerView.$el;b.animate({top:"-100%",opacity:0},350,"easeInQuint",function(){a({resetHeader:!0}),b.css({top:"0",opacity:1})})},switchAppAnimation:function(a,b){var c=this.footerView.navView.$el.find("li.active").index(),d=this.footerView.navView.$el.find("li[data-name='"+b+"']").index(),e=this.appView.getCurrentAppEl();parseInt(d)>parseInt(c)?e.animate({right:"100%"},200,"easeInQuint",function(){e.css("right","0"),a()}):e.animate({left:"100%"},200,"easeInQuint",function(){e.css("left","0"),a()})},showHomeAnimation:function(a,b){var c=b?b.ease:"easeInBack",d=this.appView.$el;if(!this.isSetAppHeight){var e=d.height();d.css("height",e+"px"),d.css("bottom","auto"),this.isSetAppHeight=!0}d.animate({opacity:0,marginTop:"100%"},350,c,function(){d.css({"margin-top":"0",opacity:1}),a()})},updateStoreApps:function(){f.set(g.apps,k.toJSON())}})}),define("ekai/seventeen-inch/1.0.0/settings.json",[],{API_URL:"http://www.topivi.com:3001/api",APP_KEY:"d7c7ce69d618446d6a84081d62682018",STORAGE_KEYS:{apps:"home_apps",home_info:"home_info",today_weather:"home_today_weather",all_weather:"home_all_weather",today_oil:"home_today_city_oil"},SOCKET_HOST:"localhost"}),define("ekai/seventeen-inch/1.0.0/data/home-info.json",[],{header:{},footer:{"nav-item-count":9,"left-app":"acn","right-app":"player"},location:"上海市",short_location:"上海",weather:{"default":{iconPath:"img/dialog-apps/weather/brighter-icon/cloud.png",temperature:{from:23,to:28},status:"多云转晴"}}}),define("ekai/seventeen-inch/1.0.0/data/apps.json",[],[{_id:1,name:"home",order:1,life_cycle:"*"},{_id:2,name:"navi",order:2,life_cycle:"*"},{_id:3,name:"phone",order:3},{_id:4,name:"acn",order:4,life_cycle:"*"},{_id:5,name:"player",order:5,life_cycle:"*"},{_id:6,name:"app-store",order:6,life_cycle:"*"},{_id:7,name:"QTFM",order:7,life_cycle:"*"}]),define("ekai/seventeen-inch/1.0.0/collections/app",["backbone","ekai/seventeen-inch/1.0.0/models/app"],function(a,b,c){var d=a("backbone"),e=a("ekai/seventeen-inch/1.0.0/models/app");c.exports=d.Collection.extend({model:e,comparator:"order",initialize:function(){},getInNavLength:function(){for(var a=0,b=0;b<this.length;b++)this.at(b).get("in_nav")&&a++;return a}})}),define("ekai/seventeen-inch/1.0.0/models/app",["backbone"],function(a,b,c){var d=a("backbone");c.exports=d.Model.extend({idAttribute:"_id",defaults:{in_nav:!0,is_native:!1,is_cache:!1,mode:"normal",life_cycle:1e4},initialize:function(){var a=this.get("name"),b="home"===a?"img/nav-apps/home_normal.png":"apps/"+a+"/icon.png";this.set("icon_path",b)}})}),define("ekai/seventeen-inch/1.0.0/templates/home.tpl",[],"<div id='home-mask'></div>\n<div id='home-mask-darker'></div>"),define("ekai/seventeen-inch/1.0.0/views/header",["jquery","backbone","underscore","store","topivi","ekai/seventeen-inch/1.0.0/settings.json","ekai/seventeen-inch/1.0.0/views/apps/wheel-press/index","ekai/seventeen-inch/1.0.0/views/apps/weather/index","ekai/seventeen-inch/1.0.0/views/apps/weather/collections/weather","ekai/seventeen-inch/1.0.0/views/apps/weather/models/weather","ekai/seventeen-inch/1.0.0/views/apps/weather/settings.json","ekai/seventeen-inch/1.0.0/views/apps/weather/weather-item","ekai/seventeen-inch/1.0.0/views/apps/oil/index","ekai/seventeen-inch/1.0.0/views/apps/oil/collections/city-oil","ekai/seventeen-inch/1.0.0/views/apps/oil/models/city-oil","ekai/seventeen-inch/1.0.0/views/apps/oil/models/today-oil","ekai/seventeen-inch/1.0.0/views/apps/VR/callback","iscroll"],function(a,b,c){var d,e,f,g,h,i,j,k=a("jquery"),l=a("backbone"),m=a("underscore"),n=a("store"),o=a("topivi"),p=a("ekai/seventeen-inch/1.0.0/settings.json"),q=p.STORAGE_KEYS,r=n.get(q.home_info),s=a("ekai/seventeen-inch/1.0.0/templates/header-big.tpl"),t=a("ekai/seventeen-inch/1.0.0/templates/header-small.tpl"),u=a("ekai/seventeen-inch/1.0.0/views/apps/wheel-press/index"),v=a("ekai/seventeen-inch/1.0.0/views/apps/weather/index"),w=a("ekai/seventeen-inch/1.0.0/views/apps/oil/index"),x=a("ekai/seventeen-inch/1.0.0/views/apps/VR/templates/index.tpl"),y={appid:"siriAppID",type:"4",test:"siri"};j=new o.dialog.normal("",{content:m.template(x),closeGesture:"swiperight clickmask"});var z=a("ekai/seventeen-inch/1.0.0/views/apps/VR/callback"),A=new o.socket("ws://"+p.SOCKET_HOST+":2001","dumb-increment-protocol",z.fn),B=new o.socket("ws://"+p.SOCKET_HOST+":2002","dumb-increment-protocol"),C=!1;z.init({dialog:j,socket:A,status:C}),A.int(),B.int(),setTimeout(function(){B.send(JSON.stringify(y))},2e3),c.exports=l.View.extend({id:"header-container",bigTemplate:m.template(s),smallTemplate:m.template(t),events:{"tap .voice-btn":"voiceBtnClickEvent","tap .big-info .weather":"weatherClickEvent","tap .big-info .maintain":"maintainClickEvent","tap .big-info .drive":"driveClickEvent","tap .alarms .icon":"alarmIconClickEvent"},constructor:function(){l.View.apply(this,arguments)},initialize:function(){var a=this;this.mode="big",this.on("changeMode",this.changeMode),k(document).on("updateHomeWeather",function(){a.updateHomeWeather()}),k(document).on("showOilDialog",function(){a.showOilDialog()}),k(document).on("getLocationWeather",function(b,c,d){a.weatherClickEvent(b,c,d)})},render:function(){return this.$el.empty(),"big"===this.mode?this.$el.html(this.bigTemplate({weather:D()})):this.$el.html(this.smallTemplate()),this.clockRunnable(),this.safeDistanceRunnable(),this},changeMode:function(a){a=a||{},this.mode=a.mode,this.render()},voiceBtnClickEvent:function(){z.status()&&(y.type="1",A.send(JSON.stringify(y)),j.open(),C=!0,z.init({status:C}))},weatherClickEvent:function(a,b,c){g||(g=new o.dialog.normal("",{useMask:!0,closeGesture:"swiperight clickmask"}),g.el.addClass("home-weather")),f||(f=new v({$parent:g.el})),b?(f.fetchData(function(){f.renderWeather(),c(f.collection.toJSON())},{location:b,doNotStore:!0}),g.setContent(f.el)):g.setContent(f.render().el),g.open()},maintainClickEvent:function(){k(document).trigger("openApp","Maintenance")},driveClickEvent:function(){k(document).trigger("openApp","Driving Habits Analysis")},showOilDialog:function(){i||(i=new o.dialog.normal("",{useMask:!0,closeGesture:"swiperight clickmask"}),i.el.addClass("home-oil")),h||(h=new w({$parent:i.el})),i.setContent(h.render().el),i.open()},wheelPressClickEvent:function(){d||(d=new u),e||(e=new o.dialog.normal("",{useMask:!0,closeGesture:"swiperight clickmask",content:d.render().el})),e.open()},alarmIconClickEvent:function(a){var b=k(a.currentTarget);if(!b.hasClass("active")){b.addClass("active");var c="";b.hasClass("front-fog")?c="前雾灯":b.hasClass("stop")?c="手刹":b.hasClass("big-light")?c="远光灯":b.hasClass("key")?c="钥匙门":b.hasClass("abs")?c="防抱死":b.hasClass("back-fog")&&(c="后雾灯");var d=new o.tips.normal("",{removeAfterHide:!0,dependEl:b,content:c,direction:"top",autoHide:!0,beforeHide:function(){b.removeClass("active")}});d.el.addClass("alarm-tips"),d.show()}},clockRunnable:function(){var a=this,b=function(){var b,c,d,e,f=a.$el.find(".header-clock"),g=new Date,h=g.getHours();h=0>h?24+h:h;var i=g.getMinutes();h>=10?(b=parseInt(h/10),c=h%10):(b=0,c=h),i>=10?(d=parseInt(i/10),e=i%10):(d=0,e=i),f.find(".dot").toggleClass("invisible"),f.find(".hour-ten").attr("class","hour-ten number"+b),f.find(".hour-bit").attr("class","hour-bit number"+c),f.find(".min-ten").attr("class","min-ten number"+d),f.find(".min-bit").attr("class","min-bit number"+e)};b(),this.clockInteval||(this.clockInteval=setInterval(b,1e3))},safeDistanceRunnable:function(){var a=this.mode,b=this.$el.find(".header-safe-distance"),c=900,d=function(){"big"===a&&(b.find(".bottom").addClass("brighter"),setTimeout(e,c))},e=function(){"big"===a&&(b.find(".middle").addClass("brighter"),setTimeout(f,c))},f=function(){"big"===a&&(b.find(".top").addClass("brighter"),setTimeout(g,c))},g=function(){"big"===a&&(b.find(".bottom, .middle, .top").removeClass("brighter"),setTimeout(d,c))};"big"===a&&setTimeout(d,c)},updateHomeWeather:function(){if("big"===this.mode){var a=D(),b=this.$el.find(".weather");b.find(".icon").attr({src:a.iconPath}),b.find(".temperature .value").text(a.temperature.from),b.find(".status").text(a.status)}}});var D=function(){var a=n.get(q.today_weather);return a?a:r.weather["default"]}}),define("ekai/seventeen-inch/1.0.0/templates/header-big.tpl",[],'<div class="top-veins"><p>上海億凯信息技术有限公司</p></div>\n<div class="voice-btn"></div>\n<div class="header-clock">\n    <div class="hour-ten"></div>\n    <div class="hour-bit"></div>\n    <div class="dot"></div>\n    <div class="min-ten"></div>\n    <div class="min-bit"></div>\n</div>\n<div class="header-safe-distance">\n    <div class="top left-top"></div>\n    <div class="middle left-middle"></div>\n    <div class="bottom left-bottom"></div>\n\n    <div class="top center-top"></div>\n    <div class="middle center-middle"></div>\n    <div class="bottom center-bottom"></div>\n\n    <div class="top right-top"></div>\n    <div class="middle right-middle"></div>\n    <div class="bottom right-bottom"></div>\n</div>\n<div class="car-container">\n    <div class="car"></div>\n</div>\n<div class="wheel-press"></div>\n<div class="big-info">\n    <div class="maintain">\n        <div class="thousand number6"></div>\n        <div class="hundred number5"></div>\n        <div class="ten number3"></div>\n        <div class="bit number7"></div>\n        <div class="dot"></div>\n        <div class="decimal number5"></div>\n    </div>\n    <div class="drive">\n        <div class="ten-thousand number2"></div>\n        <div class="thousand number3"></div>\n        <div class="hundred number5"></div>\n        <div class="ten number7"></div>\n        <div class="bit number2"></div>\n        <div class="dot"></div>\n        <div class="decimal number5"></div>\n    </div>\n    <div class="weather">\n        <img class="icon" src="{{=weather.iconPath}}"/>\n        <div class="data">\n            <p class="temperature"><span class="value">{{=weather.temperature.from}}</span><span class="unit">℃</span></p>\n            <p class="status">{{=weather.status}}</p>\n        </div>\n    </div>\n</div>\n<div class="alarms">\n    <div class="left">\n        <div class="icon front-fog"></div>\n        <div class="icon stop"></div>\n        <div class="icon big-light"></div>\n    </div>\n    <div class="right">\n        <div class="icon key"></div>\n        <div class="icon abs"></div>\n        <div class="icon back-fog"></div>\n    </div>\n</div>'),define("ekai/seventeen-inch/1.0.0/templates/header-small.tpl",[],'<div class="bg">\n    <div class="top-veins"><p>上海億凯信息技术有限公司</p></div>\n    <div class="voice-btn"></div>\n    <div class="header-clock">\n        <div class="hour-ten"></div>\n        <div class="hour-bit"></div>\n        <div class="dot"></div>\n        <div class="min-ten"></div>\n        <div class="min-bit"></div>\n    </div>\n    <div class="small-info">\n        <div class="tips"></div>\n        <div class="press">\n            <div class="wheel"></div>\n        </div>\n    </div>\n</div>'),define("ekai/seventeen-inch/1.0.0/views/apps/wheel-press/index",["backbone","underscore"],function(a,b,c){var d=a("backbone"),e=a("underscore"),f=a("ekai/seventeen-inch/1.0.0/views/apps/wheel-press/templates/index.tpl");c.exports=d.View.extend({className:"dialog-apps wheel-press",template:e.template(f),constructor:function(){d.View.apply(this,arguments)},initialize:function(){},render:function(){return this.$el.empty(),this.$el.html(this.template({frontLeft:240,frontRight:240,backLeft:180,backRight:240})),this}})}),define("ekai/seventeen-inch/1.0.0/views/apps/wheel-press/templates/index.tpl",[],'<div id="front-left-wheel" class="tip front left">\n    <div class="data"><span class="value">{{=frontLeft}}</span><span class="unit">Kpa</span></div>\n    <div class="line"></div>\n</div>\n<div id="front-right-wheel" class="tip front right">\n    <div class="data"><span class="value">{{=frontRight}}</span><span class="unit">Kpa</span></div>\n    <div class="line"></div>\n</div>\n<div id="back-left-wheel" class="tip back left">\n    <div class="data"><span class="value">{{=backLeft}}</span><span class="unit">Kpa</span></div>\n    <div class="line"></div>\n</div>\n<div id="back-right-wheel" class="tip back right">\n    <div class="data"><span class="value">{{=backRight}}</span><span class="unit">Kpa</span></div>\n    <div class="line"></div>\n</div>'),define("ekai/seventeen-inch/1.0.0/views/apps/weather/index",["backbone","underscore","topivi","store","ekai/seventeen-inch/1.0.0/settings.json","ekai/seventeen-inch/1.0.0/views/apps/weather/collections/weather","ekai/seventeen-inch/1.0.0/views/apps/weather/models/weather","ekai/seventeen-inch/1.0.0/views/apps/weather/settings.json","ekai/seventeen-inch/1.0.0/views/apps/weather/weather-item"],function(a,b,c){var d=a("backbone");a("underscore");var e=a("topivi"),f=a("store"),g=a("ekai/seventeen-inch/1.0.0/settings.json").STORAGE_KEYS,h=a("ekai/seventeen-inch/1.0.0/views/apps/weather/collections/weather"),i=a("ekai/seventeen-inch/1.0.0/views/apps/weather/weather-item"),j=a("ekai/seventeen-inch/1.0.0/views/apps/weather/templates/loading.tpl"),k=f.get(g.home_info).location;c.exports=d.View.extend({tagName:"ul",className:"dialog-apps weather",events:{"tap .item":"itemClickEvent"},constructor:function(){d.View.apply(this,arguments)},initialize:function(a){this.current=0,this.$parent=a.$parent,this.collection=new h},render:function(){var a=f.get(g.all_weather);return a?l()?(this.collection.reset(a),this.renderWeather()):(this.createLoadingWidget(),this.fetchData(this.renderWeather)):(this.createLoadingWidget(),this.fetchData(this.renderWeather)),this},fetchData:function(a,b){var c=this;b=b||{};var e=b.location||k,h=b.doNotStore;this.collection.fetch({timeout:5e3,data:{location:e},success:function(b,e){c.hideLoadingWidget(),"ok"===e.status?(b.length>0&&(h||f.set(g.today_weather,b.at(0).toJSON()),d.$(document).trigger("updateHomeWeather")),f.set(g.all_weather,b.toJSON()),a.apply(c,arguments)):c.createErrorDialog(e.msg)},error:function(){c.hideLoadingWidget(),c.createErrorDialog()}})},createLoadingWidget:function(){this.loadingWidget=new e.loading.normal("",{$parent:this.$parent,noticeContent:j,iconDirection:"center",removeAfterHide:!0,autoShow:!0})},hideLoadingWidget:function(){this.loadingWidget&&(this.loadingWidget.shown||(this.loadingWidget.shown=!0),this.loadingWidget.hide())},createErrorDialog:function(a){var b=this;a=a||"获取天气数据失败，请稍后再试...",setTimeout(function(){var c=new e.tips.normal("",{$parent:b.$el,removeAfterHide:!0,dependEl:b.$el,content:a,direction:"auto"});c.el.addClass("error-tips"),c.show()},300)},renderWeather:function(){var a=this;this.$el.empty(),this.delegateEvents(),this.collection.each(function(b){var c=new i({model:b});a.$el.append(c.render().el)}),this.$el.find("li.item:lt("+this.current+")").addClass("left"),this.$el.find("li.item:eq("+this.current+")").addClass("active"),this.$el.find("li.item:gt("+this.current+")").addClass("right")},itemClickEvent:function(a){var b=d.$(a.currentTarget),c=b.index();b.hasClass("active")||c===this.current||(this.current=c,this.renderWeather())}});var l=function(){var a=f.get(g.today_weather);if(!a)return console.error("No today weather."),!1;var b=e.util.stringToDate(a.date),c=new Date;return b.getFullYear()===c.getFullYear()&&b.getMonth()===c.getMonth()&&b.getDate()===c.getDate()}}),define("ekai/seventeen-inch/1.0.0/views/apps/weather/collections/weather",["backbone","underscore","ekai/seventeen-inch/1.0.0/views/apps/weather/models/weather","ekai/seventeen-inch/1.0.0/views/apps/weather/settings.json","store","topivi","ekai/seventeen-inch/1.0.0/settings.json"],function(a,b,c){var d=a("backbone"),e=a("underscore"),f=a("ekai/seventeen-inch/1.0.0/views/apps/weather/models/weather");a("store");var g=a("topivi").util,h=a("ekai/seventeen-inch/1.0.0/settings.json"),i=["日","一","二","三","四","五","六"];c.exports=d.Collection.extend({model:f,url:function(){return h.API_URL+"/weather/today?app_key="+h.APP_KEY},initialize:function(){},parse:function(a){var b=[];if("ok"===a.status)for(var c=g.stringToDate(a.date),d=a.data,e=d.currentCity,f=d.weather_data,h=864e5,k=0;k<f.length;k++){var l={};l.date=new Date(c.getTime()+h*k),l.day=i[l.date.getDay()],l.date=g.dateToString(l.date),l.status=f[k].weather,l.wind=f[k].wind,l.temperature=j(f[k].temperature),l.city=e,b.push(l)}return b}});var j=function(a){var b,c,d=a.split(" ~ ");return 2!==d.length?b=c=parseInt(d[0].substr(0,2)):(b=parseInt(d[0]),c=parseInt(d[1].substr(0,2))),e.isNaN(b)&&(console.error("Parse from temperature error."),b=0),e.isNaN(c)&&(console.error("Parse to temperature error."),c=0),{from:e.min([b,c]),to:e.max([b,c])}}}),define("ekai/seventeen-inch/1.0.0/views/apps/weather/models/weather",["backbone","ekai/seventeen-inch/1.0.0/views/apps/weather/settings.json"],function(a,b,c){var d=a("backbone"),e=a("ekai/seventeen-inch/1.0.0/views/apps/weather/settings.json").status_map,f="img/dialog-apps/weather/";c.exports=d.Model.extend({idAttribute:"date",defaults:{},initialize:function(){var a=this.get("status");e[a]||(a="多云",console.error("Unknown weather status."));var b=e[a].icon;this.set("iconPath",f+"brighter-icon/"+b+".png"),this.set("iconPathDarker",f+"darker-icon/"+b+".png")}})}),define("ekai/seventeen-inch/1.0.0/views/apps/weather/settings.json",[],{status_map:{"晴":{icon:"sun"},"多云转晴":{icon:"sun"},"多云":{icon:"cloud"},"晴转多云":{icon:"cloud"},"阴转多云":{icon:"cloud"},"阴":{icon:"shade"},"多云转阴":{icon:"shade"},"小雨转阴":{icon:"shade"},"阵雨":{icon:"shower"},"雷阵雨":{icon:"thundershower"},"雷阵雨伴有冰雹":{icon:"thundershower"},"雨夹雪":{icon:"rain and snow"},"小雨":{icon:"light rain"},"阴转小雨":{icon:"light rain"},"中雨":{icon:"moderate rain"},"大雨":{icon:"heavy rain"},"暴雨":{icon:"hard rain"},"大暴雨":{icon:"downpour"},"特大暴雨":{icon:"torrential rain"},"阵雪":{icon:"snow shower"},"小雪":{icon:"light snow"},"中雪":{icon:"moderate snow"},"大雪":{icon:"heavy snow"},"暴雪":{icon:"snowstorm"},"雾":{icon:"fog"},"冻雨":{icon:"snow ice"},"沙尘暴":{icon:"sand"},"小雨转中雨":{icon:"moderate rain"},"中雨转大雨":{icon:"heavy rain"},"大雨转暴雨":{icon:"hard rain"},"暴雨转大暴雨":{icon:"downpour"},"大暴雨转特大暴雨":{icon:"torrential rain"},"小雪转中雪":{icon:"moderate snow"},"中雪转大雪":{icon:"heavy snow"},"大雪转暴雪":{icon:"snowstorm"},"浮尘":{icon:"sand"},"扬沙":{icon:"sand"},"强沙尘暴":{icon:"sand"},"霾":{icon:"fog"}}}),define("ekai/seventeen-inch/1.0.0/views/apps/weather/weather-item",["backbone","underscore"],function(a,b,c){var d=a("backbone"),e=a("underscore"),f=a("ekai/seventeen-inch/1.0.0/views/apps/weather/templates/weather-item.tpl");c.exports=d.View.extend({className:"item",tagName:"li",template:e.template(f),constructor:function(){d.View.apply(this,arguments)},initialize:function(){},render:function(){return this.$el.html(this.template(this.model.attributes)),this}})}),define("ekai/seventeen-inch/1.0.0/views/apps/weather/templates/weather-item.tpl",[],'<div class="small">\n    <div class="top-info">\n        <span class="month-date">{{=date.substring(5, date.length)}}</span>\n        <span class="day">{{=day}}</span>\n    </div>\n    <img class="weather-icon" src="{{=iconPathDarker}}"/>\n</div>\n<div class="big">\n    <div class="top-info">\n        <div class="left-part">\n            <span class="city-icon"></span>\n            <span class="city">{{=city}}</span>\n        </div>\n        <div class="right-part">\n            <span class="date">{{=date}}</span>\n            <span class="day">周{{=day}}</span>\n        </div>\n    </div>\n    <p class="status">{{=status}}</p>\n    <div class="temperature">\n        <span class="value">{{=temperature.from}}</span>\n        <span class="unit">℃</span>\n    </div>\n    <img class="weather-icon" src="{{=iconPath}}"/>\n    <p class="temperature-interval">\n        <span class="temperature-icon"></span>\n        {{\n            if (temperature.from === temperature.to) {\n        }}\n            <span class="from">{{=temperature.from}}</span>\n            <span class="unit">℃</span>\n        {{\n            } else {\n        }}\n            <span class="from">{{=temperature.from}}</span>\n            <span class="unit">℃</span>\n            <span class="delimiter">/</span>\n            <span class="to">{{=temperature.to}}</span>\n            <span class="unit">℃</span>\n        {{\n            }\n        }}\n    </p>\n</div>'),define("ekai/seventeen-inch/1.0.0/views/apps/weather/templates/loading.tpl",[],'<div class="icon"></div>\n<div class="text">加载中</div>'),define("ekai/seventeen-inch/1.0.0/views/apps/oil/index",["backbone","underscore","topivi","store","ekai/seventeen-inch/1.0.0/settings.json","ekai/seventeen-inch/1.0.0/views/apps/oil/collections/city-oil","ekai/seventeen-inch/1.0.0/views/apps/oil/models/city-oil","ekai/seventeen-inch/1.0.0/views/apps/oil/models/today-oil"],function(a,b,c){var d=a("backbone"),e=a("underscore"),f=a("topivi"),g=a("store"),h=a("ekai/seventeen-inch/1.0.0/settings.json").STORAGE_KEYS,i=a("ekai/seventeen-inch/1.0.0/views/apps/oil/collections/city-oil"),j=a("ekai/seventeen-inch/1.0.0/views/apps/oil/models/today-oil"),k=a("ekai/seventeen-inch/1.0.0/views/apps/oil/templates/loading.tpl"),l=a("ekai/seventeen-inch/1.0.0/views/apps/oil/templates/city-oil.tpl"),m=a("ekai/seventeen-inch/1.0.0/views/apps/oil/templates/oil.tpl");c.exports=d.View.extend({className:"dialog-apps oil",template:e.template(l),constructor:function(){d.View.apply(this,arguments)},initialize:function(a){this.current=0,this.$parent=a.$parent,this.model=new j},render:function(){var a=g.get(h.today_oil);return a?n()?(this.model.set(a),this.renderOil()):(this.createLoadingWidget(),this.fetchData(this.renderOil)):(this.createLoadingWidget(),this.fetchData(this.renderOil)),this},fetchData:function(a){var b=this;this.model.fetch({timeout:5e3,success:function(c,d){b.hideLoadingWidget(),"ok"===d.status?(g.set(h.today_oil,c.toJSON()),a.apply(b,arguments)):b.createErrorTips(d.msg)},error:function(){b.hideLoadingWidget(),b.createErrorTips()}})},createLoadingWidget:function(){this.loadingWidget=new f.loading.normal("",{$parent:this.$parent,noticeContent:k,iconDirection:"center",removeAfterHide:!0,autoShow:!0})},hideLoadingWidget:function(){this.loadingWidget&&(this.loadingWidget.shown||(this.loadingWidget.shown=!0),this.loadingWidget.hide())},createErrorTips:function(a){var b=this;a=a||"获取油价数据失败，请稍后再试...",setTimeout(function(){var c=new f.tips.normal("",{$parent:b.$el,removeAfterHide:!0,dependEl:b.$el,content:a,direction:"auto"});c.el.addClass("error-tips"),c.show()},300)},renderOil:function(){this.$el.empty();var a=new i(this.model.get("cities")),b=a.getCurrentCityData();this.$el.html(this.template({date:this.model.get("date")}));var c=[{key:"90",value:b.get("b90")+"",name:"汽油"},{key:"93",value:b.get("b93")+"",name:"汽油"},{key:"97",value:b.get("b97")+"",name:"汽油"},{key:"0",value:b.get("b0")+"",name:"柴油"}];"".split();for(var d=0;d<c.length;d++)this.$el.find(".main").append(e.template(m)(c[d]))}});var n=function(){var a=g.get(h.today_oil);if(!a)return console.error("No today oil data."),!1;
var b=f.util.stringToDate(a.date),c=new Date;return b.getFullYear()===c.getFullYear()&&b.getMonth()===c.getMonth()&&b.getDate()===c.getDate()}}),define("ekai/seventeen-inch/1.0.0/views/apps/oil/collections/city-oil",["backbone","underscore","ekai/seventeen-inch/1.0.0/views/apps/oil/models/city-oil","store","ekai/seventeen-inch/1.0.0/settings.json"],function(a,b,c){var d=a("backbone");a("underscore");var e=a("ekai/seventeen-inch/1.0.0/views/apps/oil/models/city-oil"),f=a("store"),g=a("ekai/seventeen-inch/1.0.0/settings.json"),h=g.STORAGE_KEYS,i=f.get(h.home_info).short_location;c.exports=d.Collection.extend({model:e,initialize:function(){},getCurrentCityData:function(){return this.find(function(a){return a.get("city").indexOf(i)>=0})}})}),define("ekai/seventeen-inch/1.0.0/views/apps/oil/models/city-oil",["backbone"],function(a,b,c){var d=a("backbone");c.exports=d.Model.extend({idAttribute:"_id",initialize:function(){}})}),define("ekai/seventeen-inch/1.0.0/views/apps/oil/models/today-oil",["backbone","store","topivi","ekai/seventeen-inch/1.0.0/settings.json"],function(a,b,c){var d=a("backbone"),e=a("store"),f=a("topivi").util,g=a("ekai/seventeen-inch/1.0.0/settings.json"),h=g.STORAGE_KEYS;e.get(h.home_info).short_location,c.exports=d.Model.extend({idAttribute:"_id",url:function(){return g.API_URL+"/oil-city/today?app_key="+g.APP_KEY},initialize:function(){},parse:function(a){var b={};return"ok"===a.status&&(b={date:f.dateToString(f.stringToDate(a.date),"-"),cities:a.cities}),b}})}),define("ekai/seventeen-inch/1.0.0/views/apps/oil/templates/loading.tpl",[],'<div class="icon"></div>\n<div class="text">加载中</div>'),define("ekai/seventeen-inch/1.0.0/views/apps/oil/templates/city-oil.tpl",[],'<div class="wrapper">\n    <div class="header">\n        <h1 class="title">油价<span class="unit">（元/升）</span></h1>\n        <span class="date">{{=date}}</span>\n    </div>\n    <div class="main">\n    </div>\n    <div class="cb"></div>\n    <p class="desc">*实际价格请以当地加油站的报价为准</p>\n</div>'),define("ekai/seventeen-inch/1.0.0/views/apps/oil/templates/oil.tpl",[],'<div class="item">\n    <div class="label">\n        <h2 class="flag">{{=key}}<span class="jinhao">#</span></h2>\n        <p class="name">{{=name}}</p>\n    </div>\n    {{\n        var parts = value.split(\'.\');\n        if (parts.length !== 2) {\n            parts = [\'00\', \'00\'];\n        }\n        var ten, bit, ten_, bit_;\n        if (parts[0].length === 2) {\n            ten = parts[0].substr(0, 1);\n            bit = parts[0].substr(1, 1);\n        } else {\n            ten = 0;\n            bit = parts[0];\n        }\n        if (parts[1].length === 2) {\n            bit_ = parts[1].substr(0, 1);\n            ten_ = parts[1].substr(1, 1);\n        } else {\n            ten_ = 0;\n            bit_ = parts[1];\n        }\n    }}\n    <div class="value">\n        <div class="number" data-value="{{=parseInt(ten) > 0 ? ten : \'none\'}}"></div>\n        <div class="number" data-value="{{=bit}}"></div>\n        <div class="dot"></div>\n        <div class="number" data-value="{{=bit_}}"></div>\n        <div class="number" data-value="{{=ten_}}"></div>\n    </div>\n</div>'),define("ekai/seventeen-inch/1.0.0/views/apps/VR/templates/index.tpl",[],'\n<div class="VR">\n    <div class="title">倾听您的指令</div>\n    <div class="content"></div>\n    <div class="bg-bottom">\n        <div class="VR-animation1"></div>\n        <div class="VR-animation2"></div>\n        <div class="machine-words"></div>\n    </div>\n</div>\n'),define("ekai/seventeen-inch/1.0.0/views/apps/VR/callback",["jquery","backbone","underscore","iscroll","store","topivi"],function(require,exports,module){var $=require("jquery"),Backbone=require("backbone"),_=require("underscore"),iscroll=require("iscroll"),store=require("store"),topivi=require("topivi"),commandTemplate=require("ekai/seventeen-inch/1.0.0/views/apps/VR/templates/command.tpl"),answerTemplate=require("ekai/seventeen-inch/1.0.0/views/apps/VR/templates/answer.tpl"),temp,responseType,onsTimer,findMusic,dialog=null,topiviSocket=null,status=null,songs=null,weatherData=null,Json={appid:"siriAppID",type:"3",test:""};exports.init=function(a){a=a||{},a.dialog&&(dialog=a.dialog),a.socket&&(topiviSocket=a.socket),void 0!=a.status&&null!=a.status&&(status=a.status)},exports.status=function(){return 0==status},exports.fn=function(e){console.log(e.data);var result=eval("("+e.data+")");switch("machine"==result.speaker&&"yes"==result.speakContentExist&&($(".VR-animation1").addClass("select").show(),""==Json.test?$(".machine-words").text(result.speakContent).show():($(".machine-words").text(Json.test).show(),Json.test="")),"machine"==result.speaker&&"yes"==result.commandExist&&(temp=_.template(commandTemplate),$(".VR .content").html(temp(result))),"record"==result.speaker&&($(".VR-animation2").show(),$(".VR-animation1").hide(),$(".machine-words").hide()),"iat"==result.speaker&&(responseType="",$(".VR-animation2").hide(),$(".VR-animation1").removeClass(".select")),result.opetype){case"1":"5MA6VxmSYR.MediaP"==result.setappid?($(document).trigger("openApp","player"),$(document).trigger("getPlayerSongList",function(a){songs={command:_.pluck(a,"title")}}),temp=_.template(commandTemplate),$(".VR .content").empty().html(temp(songs))):"pyQvMFdkMd.navi"==result.setappid&&$(document).trigger("openApp","navi");break;case"3":if(responseType="music",131073==result.settype)findMusic=_.find(songs.command,function(a){return $.trim(a)==$.trim(result.setinfoText)}),findMusic?$(document).trigger("playSong",findMusic):(Json.test='未找到"'+result.setinfoText+'"，将为您随机播放',topiviSocket.send(JSON.stringify(Json)),$(document).trigger("randomPlaySong"));else if(131074==result.settype)switch(result.setinfoText){case"播放":console.log("播放");break;case"暂停":console.log("暂停");break;case"上一首":console.log("上一首");break;case"下一首":console.log("下一首")}break;case"7":switch(status=!1,responseType){case"":onsTimer=1e3;break;case"music":onsTimer=3e3;break;case"answer":onsTimer=!1;break;case"query":onsTimer=!1;break;case"weather":onsTimer=100;break;case"oil":onsTimer=1e3}onsTimer&&setTimeout(function(){dialog.close()},onsTimer)}if(void 0!=result.rc&&null!=result.rc)if(result.rc<=3)switch(result.operation){case"ANSWER":responseType="answer",temp=_.template(answerTemplate),$(".VR .content").empty().html(temp(result)),setTimeout(function(){new iscroll(".VR .content .command-list")},100),Json.test=result.answer.text,topiviSocket.send(JSON.stringify(Json)),Json.test="";break;case"QUERY":if(responseType="query","weather"==result.service){responseType="weather";var queryCity=result.semantic.slots.location.city;"CURRENT_CITY"==queryCity&&(queryCity="上海"),$(document).trigger("getLocationWeather",[queryCity,function(a){weatherData=a,Json.test="今天"+weatherData[0].date+","+"星期"+weatherData[0].day+","+weatherData[0].status+","+weatherData[0].wind+","+"最高温度"+weatherData[0].temperature.to+"度"+","+"最低温度"+weatherData[0].temperature.from+"度",topiviSocket.send(JSON.stringify(Json)),Json.test=""}])}break;case"PLAY":responseType="music",$(document).trigger("openApp","player"),$(document).trigger("getPlayerSongList",function(a){songs={command:_.pluck(a,"title")}}),findMusic=_.find(songs.command,function(a){return $.trim(a)==$.trim(result.semantic.slots.song)}),setTimeout(function(){findMusic?$(document).trigger("playSong",findMusic):(Json.test='未找到"'+result.semantic.slots.song+'"，将为您随机播放',topiviSocket.send(JSON.stringify(Json)),$(".VR-animation1").show(),$(".machine-words").show().text(Json.test),Json.test="",$(document).trigger("randomPlaySong"))},2e3);break;case"LAUNCH":if("radio"==result.service){var playinfo=result.semantic.slots.name;console.log("playinfo :"+playinfo)}}else-1!=result.text.indexOf("油价")&&(responseType="oil",$(document).trigger("showOilDialog"))}}),define("ekai/seventeen-inch/1.0.0/views/apps/VR/templates/command.tpl",[],'<ul class="command-list">\n    {{\n    for (var i = 0; i < command.length; i++) {\n    }}\n    <li class="command">{{=command[i]}}</li>\n    {{\n    }\n    }}\n</ul>'),define("ekai/seventeen-inch/1.0.0/views/apps/VR/templates/answer.tpl",[],'<ul class="command-list">\n    <li class="answer">{{=answer.text}}</li>\n</ul>\n'),define("ekai/seventeen-inch/1.0.0/views/app",["jquery","backbone","underscore","store","ekai/seventeen-inch/1.0.0/settings.json"],function(a,b,c){var d=a("jquery"),e=a("backbone");a("underscore");var f=a("store"),g=a("ekai/seventeen-inch/1.0.0/settings.json").STORAGE_KEYS,h=f.get(g.home_info);h||console.error("Not found home_info storage"),c.exports=e.View.extend({id:"app-container",constructor:function(){e.View.apply(this,arguments)},initialize:function(a){this.appCollection=a.appCollection,this.appManager={};var b=h.footer["left-app"],c=h.footer["right-app"];this.createApp(b),this.createApp(c),this.currentApp=null,this.prevApp=null,this.on("switchApp",this.switchApp)},render:function(){if(this.currentApp){var a=h.footer["left-app"],b=h.footer["right-app"],c=this.searchApp(this.currentApp),e=this.searchApp(this.prevApp),f=c.iframe();e&&(d(e.iframe()).removeClass("active"),e.clearRunnable()),d(f).addClass("active");var g=c.model.get("name");f.src&&g!==a&&g!==b||(f.src=i(this.currentApp)),this.$el.find(".active").length<=0&&this.$el.append(f),c.runnable&&clearTimeout(c.runnable)}return this},createApp:function(a){var b=this,c=this.appCollection.findWhere({name:a});if(!c)return console.error("Not found app: "+a),void 0;var e={iframe:function(){var a=this.model.get("name"),c=b.$el.find("iframe[data-name='"+a+"']");return(!c||c.length<=0)&&(c=d("#footer-apps").find("iframe[data-name='"+a+"']"),(!c||c.length<=0)&&(c=d(document.createElement("iframe")),c.attr({"data-name":a}))),c[0]},model:c,clearRunnable:function(){var a=this.model.get("life_cycle"),c=this.model.get("name");"*"!==a&&(this.runnable=setTimeout(function(){b.clearApp(c)},a))}};return this.appManager[a]=e,this.$el.append(e.iframe()),e},clearApp:function(a){var b=this.appManager[a];return b?(d(b.iframe()).remove(),this.appManager[a]=void 0,void 0):console.error("App "+a+"has not exist.")},getCurrentAppEl:function(){var a=null;return this.currentApp&&(a=d(this.searchApp(this.currentApp).iframe())),a},searchApp:function(a){return this.appManager[a]},switchApp:function(a){var b=this.searchApp(a);b||this.createApp(a),this.prevApp=this.currentApp,this.currentApp=a,this.render()}});var i=function(a){return"apps/"+a+"/index.html#"}}),define("ekai/seventeen-inch/1.0.0/views/footer",["backbone","underscore","ekai/seventeen-inch/1.0.0/views/nav","iscroll","ekai/seventeen-inch/1.0.0/views/nav-item","ekai/seventeen-inch/1.0.0/views/footer-apps","store","ekai/seventeen-inch/1.0.0/settings.json"],function(a,b,c){var d=a("backbone");a("underscore");var e=a("ekai/seventeen-inch/1.0.0/views/nav"),f=a("ekai/seventeen-inch/1.0.0/views/footer-apps");c.exports=d.View.extend({id:"footer-container",constructor:function(){d.View.apply(this,arguments)},initialize:function(a){this.navView=new e({collection:a.appCollection}),this.appsView=new f({appManager:a.appManager})},render:function(){return this.$el.empty(),this.$el.append(this.navView.render().el),this.$el.append(this.appsView.render().el),this}})}),define("ekai/seventeen-inch/1.0.0/views/nav",["backbone","underscore","iscroll","ekai/seventeen-inch/1.0.0/views/nav-item"],function(a,b,c){var d=a("backbone"),e=a("underscore"),f=a("iscroll"),g=a("ekai/seventeen-inch/1.0.0/views/nav-item");c.exports=d.View.extend({id:"footer-nav",constructor:function(){d.View.apply(this,arguments)},initialize:function(){var a=this;this.displayNum=9,this.navItemViews={},this.listenTo(this.collection,"add",this.appendAppItem),d.$(document).on("installApp",function(){a.installApp.apply(a,arguments)}),d.$(document).on("uninstallApp",function(){a.uninstallApp.apply(a,arguments)})},render:function(){var a=this;this.$el.empty(),this.$el.append("<ul id='nav-list'></ul>");var b=this.$el.find("#nav-list");return e.each(this.collection.models,function(c){var d=c.get("name"),e=new g({model:c});a.listenTo(c,"remove",a.removeAppItem),a.navItemViews[d]=e,b.append(e.render().el)}),setTimeout(function(){a.resetScrollWidth(),a.scroll=new f("#footer-nav",{scrollX:!0,scrollY:!1})},100),d.$(window).resize(function(){a.resetScrollWidth()}),this},installApp:function(a,b){var c=this,d=b.callback,e=b.app,f=this.collection.model,g=this.collection.at(this.collection.length-1);e.order=g.get("order")+1,setTimeout(function(){var a=new f(e);c.listenTo(a,"remove",c.removeAppItem),c.collection.add(a),c.collection.trigger("updateHomeApps"),d()},2e3)},uninstallApp:function(a,b){var c=this,d=b.callback,e=b.app,f=this.collection.get(e.id);setTimeout(function(){f&&(c.collection.remove(f),c.collection.trigger("updateHomeApps")),d()},1e3)},appendAppItem:function(a){var b=this.$el.find("#nav-list"),c=new g({model:a});b.append(c.render().el),this.resetScrollWidth(),this.scroll.refresh(),this.scroll.scrollToElement(c.$el[0],1e3)},removeAppItem:function(){this.resetScrollWidth(),this.scroll.refresh()},resetScrollWidth:function(){var a=this.$el.find("#nav-list"),b=this.collection.length;this.$el.find("li.none").remove();for(var c=b;c<this.displayNum;c++)a.append("<li class='none' data-name='none_"+c+"'></li>");b=b>this.displayNum?b:this.displayNum;var d=this.$el.width(),e=(d-this.displayNum+1)/this.displayNum;this.$el.find("li").css("width",e+"px");var f=b*e+b;a.css("width",f+"px")},activeItem:function(a){this.$el.find("li.active").removeClass("active");var b=this.$el.find("li[data-name='"+a+"']");b.addClass("active"),this.scrollToEl(b)},scrollToEl:function(a){if(this.scroll){var b=1e3,c=this.$el.width(),d=a.width(),e=a.offset().left;if(d>e){var f=a.prev();f.length>0?this.scroll.scrollToElement(f[0],b):this.scroll.scrollToElement(a[0],b)}else if(e>c-d){var g=a.next();g.length>0?this.scroll.scrollToElement(g[0],b):this.scroll.scrollToElement(a[0],b)}else this.scroll.scrollToElement(a[0],b)}}})}),define("ekai/seventeen-inch/1.0.0/views/nav-item",["backbone","underscore"],function(a,b,c){var d=a("backbone"),e=a("underscore"),f=a("ekai/seventeen-inch/1.0.0/templates/nav-item.tpl");c.exports=d.View.extend({tagName:"li",template:e.template(f),constructor:function(){d.View.apply(this,arguments)},initialize:function(){var a=this.model.get("name");this.$el.attr("data-name",a),this.listenTo(this.model,"remove",this.appUninstalled)},render:function(){return this.$el.empty(),this.$el.html(this.template(this.model.attributes)),this},appUninstalled:function(){this.remove()}})}),define("ekai/seventeen-inch/1.0.0/templates/nav-item.tpl",[],'<a href="#{{=name}}">\n    <img alt="{{=name}}" class="icon" src="{{=icon_path}}"/>\n</a>'),define("ekai/seventeen-inch/1.0.0/views/footer-apps",["underscore","backbone","store","ekai/seventeen-inch/1.0.0/settings.json"],function(a,b,c){var d=a("underscore"),e=a("backbone"),f=a("ekai/seventeen-inch/1.0.0/templates/footer-apps.tpl"),g=a("store"),h=a("ekai/seventeen-inch/1.0.0/settings.json").STORAGE_KEYS,i=g.get(h.home_info);i||console.error("Not found home_info storage"),c.exports=e.View.extend({id:"footer-apps",template:d.template(f),constructor:function(){e.View.apply(this,arguments)},initialize:function(a){this.mode="both",this.leftAppName=i.footer["left-app"],this.rightAppName=i.footer["right-app"],this.appManager=a.appManager,this.on("switchApp",this.switchApp),this.on("resetApp",this.resetApp)},render:function(){return this.$el.empty(),this.$el.html(this.template()),this.changeAppsStyle(),this},changeAppsStyle:function(){var a=this.appManager[this.leftAppName].iframe(),b=this.appManager[this.rightAppName].iframe();a&&b||console.error("Foot app left or right not existed.");var c=this.$el.find("#left-container"),d=this.$el.find("#right-container");switch(this.mode){case"left":a.src=j(this.leftAppName,"footer-expanded"),c.find("iframe").length<=0&&c.append(a);break;case"right":b.src=j(this.rightAppName,"footer-expanded"),d.find("iframe").length<=0&&d.append(b);break;case"both":a.src=j(this.leftAppName,"footer"),c.find("iframe").length<=0&&c.append(a),b.src=j(this.rightAppName,"footer"),d.find("iframe").length<=0&&d.append(b)}},hideEl:function(a){a.removeClass("expanded").addClass("hide")},expandEl:function(a){a.removeClass("hide").addClass("expanded")},resetEl:function(a){a.removeClass("hide").removeClass("expanded")},switchApp:function(a,b){this.mode="left"===a?"right":"left";var c=this.$el.find("#left-container"),d=this.$el.find("#right-container");"left"===this.mode?(this.decreaseAnimation(d,"all",function(){this.hideEl(d),this.changeAppsStyle(),b()}),this.expandAnimation(c,"all",function(){this.expandEl(c)})):(this.decreaseAnimation(c,"all",function(){this.hideEl(c),this.changeAppsStyle(),b()}),this.expandAnimation(d,"all",function(){this.expandEl(d)}))},resetApp:function(a){this.mode="both";var b=this.$el.find("#left-container"),c=this.$el.find("#right-container");"right"==a?(this.decreaseAnimation(c,"right",function(){this.resetEl(c),this.changeAppsStyle()}),this.expandAnimation(b,"left",function(){this.resetEl(b)})):(this.decreaseAnimation(b,"left",function(){this.resetEl(b),this.changeAppsStyle()}),this.expandAnimation(c,"right",function(){this.resetEl(c)}))},expandAnimation:function(a,b,c){var d,e=200,f="easeInQuint",g=this;d="right"==b?"33%":"left"==b?"65.5%":"100%",a.animate({width:d},e,f,function(){c.call(g)})},decreaseAnimation:function(a,b,c){var d,e=200,f="easeInQuint",g=this;d="right"==b?"33%":"left"==b?"65.5%":"0",a.animate({width:d},e,f,function(){c.call(g)})}});var j=function(a,b){var c="apps/"+a+"/index.html";return b&&(c+="#$mode/"+b),c}}),define("ekai/seventeen-inch/1.0.0/templates/footer-apps.tpl",[],'<div id="left-container"></div>\n<div id="right-container"></div>');
